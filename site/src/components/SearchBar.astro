---
// SearchBar component - client-side search functionality
---

<div class="relative">
  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
    <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
    </svg>
  </div>
  <input
    type="search"
    id="search-input"
    placeholder="Search projects, materials, locations..."
    class="block w-full pl-10 pr-4 py-3 border border-nordic-200 rounded-xl bg-white text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-nordic-500 focus:border-nordic-500 transition-colors"
  />
  <div id="search-results-count" class="absolute inset-y-0 right-0 pr-3 flex items-center text-sm text-gray-400">
    <!-- Results count will be inserted here -->
  </div>
</div>

<script>
  // Search functionality
  const searchInput = document.getElementById('search-input');
  const resultsCount = document.getElementById('search-results-count');

  let debounceTimer;

  searchInput?.addEventListener('input', (e) => {
    clearTimeout(debounceTimer);
    debounceTimer = setTimeout(() => {
      const query = e.target.value.toLowerCase().trim();

      // Dispatch custom event for filtering
      window.dispatchEvent(new CustomEvent('search', { detail: { query } }));
    }, 200);
  });

  // Listen for filter results to update count
  window.addEventListener('filterResults', (e) => {
    if (resultsCount) {
      const count = e.detail.count;
      resultsCount.textContent = count > 0 ? `${count} projects` : '';
    }
  });
</script>
